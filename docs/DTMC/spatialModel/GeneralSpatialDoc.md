# Spatial Models

## Note
Because most of the functions for all the spatial models operate the same way after initializing the object, the examples will done using HubSIS. 

## Examples

### Spatial Model object
After initializing the spatial model, the simulation must be run in order to get the final outputs. For this, the run() function is used.

```python
    from Eir import HubSIS
    # initialize the object
    test = HubSIS(S0=999, I0=1, pss=.2, rstart=3, side=25, days=31, gamma=.3)
    # run the object
    details = test.run()
```

By default, run() returns a Simul_Details object, which allows the user to get deeper information about the simulation, such as transmission chains and state histories. If that isn't wanted, set getDetails=False in the run function.

```python
    from Eir import HubSIS
    test = HubSIS(S0=999, I0=1, pss=.2, rstart=3, side=25, days=31, gamma=.3)
    test.run(getDetails=False)
```

Now that the simulation has been run, there are different things that can be done with the simulation. If the data is wanted in a pandas DataFrame, the toDataFrame() method will return the data in the form of a pandas DataFrame.

```python 

    df = test.toDataFrame()
```

When printing the dataframe, the output will be something like this:

```shell
>>> print(df)
    Days  Susceptible  Infected
0    0.0        999.0       1.0
1    1.0        996.0       4.0
2    2.0        982.0      18.0
3    3.0        949.0      51.0
4    4.0        830.0     170.0
5    5.0        647.0     353.0
6    6.0        463.0     537.0
7    7.0        275.0     725.0
8    8.0        246.0     754.0
9    9.0        224.0     776.0
10  10.0        256.0     744.0
11  11.0        215.0     785.0
12  12.0        213.0     787.0
13  13.0        222.0     778.0
14  14.0        240.0     760.0
15  15.0        224.0     776.0
16  16.0        225.0     775.0
17  17.0        247.0     753.0
18  18.0        261.0     739.0
19  19.0        240.0     760.0
20  20.0        235.0     765.0
21  21.0        223.0     777.0
22  22.0        230.0     770.0
23  23.0        225.0     775.0
24  24.0        225.0     775.0
25  25.0        210.0     790.0
26  26.0        225.0     775.0
27  27.0        214.0     786.0
28  28.0        228.0     772.0
29  29.0        213.0     787.0
30  30.0        226.0     774.0
31  31.0        250.0     750.0

```

### Simul_Details

In the case that getDetails=True, interacting with the Simul_Details object can prove insightful. One useful function is the personHistory function, which will get the state history of the person number on each day. The persons are number from 0 to one less than the population size. For example, if there were 1000 people, the people would be identified as Person 0, Person 1, Person 2... Person 998, Person 999. 

```python

>>> from Eir import HubSIS
>>> test = HubSIS(S0=999, I0=1, pss=.2, rstart=3, side=25, days=31, gamma=.3)
>>> details = test.run()
>>> print(details.personHistory(9))
[(0, 'S'), (4, 'I'), (7, 'S'), (8, 'I'), (9, 'S'), (10, 'I'), (12, 'S'), (13, 'I'), (18, 'S'), (19, 'I'), (21, 'S'), (22, 'I'), (23, 'S'), (24, 'I'), (25, 'S'), (26, 'I'), (27, 'S'), (28, 'I'), (29, 'S'), (30, 'I'), (31, 'S')]
>>> 

```
The personHistory method returns a list of tuples. The 0th element of the tuple is the day, and the second element of the tuple is a string denoting the state they switched to that day. 

There is a default variable movementHistory which can be set to True, which then returns a list containing the state history in the 0th element, and a list of (x,y) coordinates of the particular person in the 1st element. Below is a script that one can run to access that information

```python
>>> from Eir import HubSIS

>>> # initialize object
>>> test = HubSIS(S0=999, I0=1, pss=.2, side=25, days=31, gamma=.3, rstart=3)
>>> # run the simulation
>>> d = test.run()
>>> # ge the list in the 1st element of the value returned by personHistory
>>> a = d.personHistory(9, True)[1]
>>> print(a)
[(13.215897854222156, 18.688142252818587)]
```

One can also view the people that a Person u infected by using the personTransmissionHistory() method. By inputting a number, u, the method will return of tuples that represent the person that u infected in the 0th element of each tuple, as well as the day it occured, the 1st element of each tuple.

```python 

>>>b = d.personTransmissionHistory(9)
>>>print(b)
[(305, 7), (369, 7), (636, 7), (544, 8), (897, 8), (897, 12), (369, 13), (636, 15), (897, 15), (82, 16), (224, 16), (169, 17), (11, 18), (408, 19), (564, 22), (224, 24), (95, 26), (601, 27), (636, 27), (957, 27), (95, 28), (601, 29), (957, 30)]
```
If we look at this list, we can see that perosn 9 infected person 305 on day 7, person 369 on 7, etc.

If one is interested in the transmission history on a particular day of the entire system rather than an individual, the transmissionHistoryOnDay() method will prove useful. 

```python

>>> c = d.transmissionHistoryOnDay(9)
>>> print(c)
[(2, 274), (2, 470), (3, 255), (3, 536), (6, 568), (9, 155), (9, 520), (9, 528), (9, 535), (9, 588), (9, 648), (9, 997), (10, 194), (10, 260), (10, 943), (11, 347), (11, 421), (11, 644), (11, 650), (11, 985), (13, 387), (14, 1), (16, 267), (16, 298), (16, 610), (16, 899), (17, 8), (17, 174), (17, 186), (17, 191), (17, 195), (17, 512), (17, 530), (17, 573), (17, 661), (17, 729), (17, 861), (19, 557), (19, 915), (21, 958), (21, 983), (22, 643), (22, 698), (23, 18), (23, 60), (23, 83), (23, 137), (23, 673), (24, 342), (24, 442), (24, 612), (24, 718), (24, 773), (24, 809), (24, 816), (24, 857), (24, 863), (25, 7), (25, 140), (25, 345), (26, 203), (26, 844), (27, 821), (28, 89), (28, 178), (28, 538), (28, 575), (30, 497), (30, 609), (31, 111), (31, 166), (31, 376), (31, 814), (33, 653), (33, 741), (35, 756), (35, 895), (36, 426), (36, 508), (37, 122), (37, 128), (37, 169), (37, 196), (37, 304), (37, 965), (38, 364), (38, 772), (39, 822), (39, 930), (40, 201), (40, 606), (40, 611), (40, 807), (40, 840), (40, 992), (41, 386), (41, 790), (42, 443), (42, 923), (43, 391), (44, 129), (44, 764), (49, 542), (50, 56), (50, 124), (50, 135), (50, 216), (50, 268), (50, 486), (50, 724), (50, 738), (52, 71), (52, 305), (52, 554), (54, 45), (54, 357), (54, 371), (54, 377), (54, 655), (54, 910), (55, 394), (58, 626), (58, 675), (58, 734), (58, 869), (62, 330), (62, 980), (66, 205), (66, 973), (68, 412), (68, 441), (70, 549), (72, 107), (72, 296), (72, 502), (72, 815), (72, 927), (73, 988), (74, 663), (77, 707), (80, 34), (80, 113), (80, 900), (81, 161), (81, 189), (88, 0), (90, 665), (90, 744), (92, 158), (92, 995), (93, 117), (93, 192), (93, 352), (93, 550), (93, 692), (93, 702), (95, 320), (96, 258), (100, 200), (100, 471), (100, 926), (108, 289), (108, 479), (112, 901), (118, 168), (118, 343), (118, 960), (119, 338), (119, 545), (131, 299), (133, 327), (136, 546), (143, 847), (144, 605), (144, 703), (146, 220), (147, 736), (152, 820), (154, 595), (160, 4), (162, 722), (173, 465), (177, 395), (177, 630), (179, 921), (180, 358), (202, 775), (206, 831), (210, 416), (210, 419), (211, 526), (222, 404), (224, 491), (225, 244), (228, 614), (229, 642), (237, 681), (240, 427), (246, 506), (249, 931), (265, 689), (270, 451), (281, 667), (282, 253), (292, 105), (292, 577), (324, 582), (331, 523), (399, 695), (462, 193), (507, 714), (566, 308), (651, 151)]
```

When interpreting this data, each tuple has 2 persons: the person in element 0 of each tuple is the infectious person, while the person in element 1 is the susceptible person that got infected. Therefore, looking at the first tuple, person 2 infected person 274 on day 9.

If one wants the number of transmissions, the sortedTransmissions() will return the transmissions, sorted in descending order, as well as the persons that got that many transmissions.

```python

>>>e = d.sortedTransmissions()
>>>print(e)
[(193.0, [28]), (180.0, [19]), (178.0, [15]), (176.0, [30]), (158.0, [65]), (154.0, [41]), (152.0, [6, 58]), (136.0, [43]), (129.0, [79]), (116.0, [56]), (103.0, [158]), (100.0, [53, 70]), (95.0, [69]), (94.0, [39]), (86.0, [102, 127]), (81.0, [109]), (77.0, [61]), (76.0, [131]), (67.0, [90]), (66.0, [148]), (57.0, [145]), (55.0, [83]), (53.0, [71]), (50.0, [17]), (49.0, [163]), (48.0, [27]), (47.0, [184, 185]), (46.0, [40, 161]), (45.0, [48]), (44.0, [8, 129, 142]), (43.0, [218]), (42.0, [0, 1]), (41.0, [110, 169]), (40.0, [7, 18]), (39.0, [2]), (38.0, [13]), (37.0, [3, 187]), (36.0, [16]), (35.0, [162]), (34.0, [10, 202]), (33.0, [20]), (32.0, [95]), (31.0, [29, 101]), (30.0, [11, 25, 213]), (29.0, [9, 23, 166]), (28.0, [103, 155, 172]), (27.0, [52]), (26.0, [4]), (25.0, [80, 87]), (24.0, [59, 159]), (23.0, [5, 32, 55, 126]), (22.0, [34, 188, 211, 251, 296]), (21.0, [21, 66, 96, 100, 235]), (20.0, [31, 37, 51, 147, 234]), (19.0, [36, 46, 119, 186, 203]), (18.0, [26, 47, 50, 60, 72, 82]), (17.0, [63, 84, 86, 89, 111, 264, 299]), (16.0, [12, 14, 22, 42, 45, 74, 106, 201, 317, 436]), (15.0, [49, 73, 75, 122, 140, 284, 314, 607]), (14.0, [62, 64, 85, 250, 339]), (13.0, [76, 91, 123, 133, 365]), (12.0, [38, 67, 77, 99, 116, 236, 287, 355, 721, 964]), (11.0, [35, 78, 107, 136, 154, 200, 239, 276, 305, 361]), (10.0, [54, 68, 94, 97, 112, 115, 121, 138, 167, 171, 196, 999]), (9.0, [57, 92, 104, 149, 156, 206, 219, 246, 315, 864]), (8.0, [88, 125, 130, 151, 152, 194, 277, 301, 348, 354, 378, 572]), (7.0, [24, 81, 93, 98, 117, 124, 128, 139, 141, 227, 295, 446]), (6.0, [113, 134, 137, 192, 238, 268, 379, 421, 430, 640, 658, 715, 811]), (5.0, [44, 191, 247, 254, 313, 328, 334, 343, 395, 404, 522, 605, 678, 966]), (4.0, [153, 157, 164, 165, 175, 181, 182, 190, 198, 199, 208, 220, 223, 245, 252, 258, 288, 345, 359, 370, 384, 429, 454, 488, 489, 490, 610, 871]), (3.0, [33, 105, 108, 135, 143, 144, 150, 168, 173, 176, 177, 180, 195, 226, 232, 265, 304, 306, 332, 337, 352, 362, 371, 381, 385, 387, 390, 394, 464, 483, 517, 533, 534, 697, 837, 939, 954]), (2.0, [118, 132, 178, 179, 183, 204, 207, 209, 210, 212, 224, 230, 237, 241, 242, 274, 278, 297, 318, 319, 325, 327, 335, 342, 363, 366, 374, 402, 411, 412, 413, 449, 450, 452, 461, 479, 492, 495, 501, 512, 514, 540, 547, 571, 582, 598, 600, 602, 604, 616, 619, 686, 691, 718, 809, 823, 835, 838, 842, 899, 916, 946]), (1.0, [114, 160, 189, 205, 222, 225, 231, 233, 240, 243, 244, 253, 256, 257, 259, 260, 263, 267, 271, 280, 281, 282, 285, 286, 290, 298, 308, 309, 311, 322, 329, 346, 347, 349, 351, 353, 373, 388, 391, 393, 409, 418, 420, 426, 428, 431, 432, 440, 447, 451, 455, 475, 476, 477, 482, 485, 493, 498, 500, 504, 511, 515, 519, 548, 554, 559, 562, 564, 568, 570, 576, 577, 581, 583, 584, 587, 593, 603, 629, 630, 643, 655, 662, 664, 675, 676, 684, 696, 704, 705, 710, 728, 754, 804, 819, 865, 880, 891, 913, 925, 931, 958, 961, 968]), (0.0, [120, 146, 170, 174, 193, 197, 214, 215, 216, 217, 221, 228, 229, 248, 249, 255, 261, 262, 266, 269, 270, 272, 273, 275, 279, 283, 289, 291, 292, 293, 294, 300, 302, 303, 307, 310, 312, 316, 320, 321, 323, 324, 326, 330, 331, 333, 336, 338, 340, 341, 344, 350, 356, 357, 358, 360, 364, 367, 368, 369, 372, 375, 376, 377, 380, 382, 383, 386, 389, 392, 396, 397, 398, 399, 400, 401, 403, 405, 406, 407, 408, 410, 414, 415, 416, 417, 419, 422, 423, 424, 425, 427, 433, 434, 435, 437, 438, 439, 441, 442, 443, 444, 445, 448, 453, 456, 457, 458, 459, 460, 462, 463, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 478, 480, 481, 484, 486, 487, 491, 494, 496, 497, 499, 502, 503, 505, 506, 507, 508, 509, 510, 513, 516, 518, 520, 521, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 535, 536, 537, 538, 539, 541, 542, 543, 544, 545, 546, 549, 550, 551, 552, 553, 555, 556, 557, 558, 560, 561, 563, 565, 566, 567, 569, 573, 574, 575, 578, 579, 580, 585, 586, 588, 589, 590, 591, 592, 594, 595, 596, 597, 599, 601, 606, 608, 609, 611, 612, 613, 614, 615, 617, 618, 620, 621, 622, 623, 624, 625, 626, 627, 628, 631, 632, 633, 634, 635, 636, 637, 638, 639, 641, 642, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 656, 657, 659, 660, 661, 663, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 677, 679, 680, 681, 682, 683, 685, 687, 688, 689, 690, 692, 693, 694, 695, 698, 699, 700, 701, 702, 703, 706, 707, 708, 709, 711, 712, 713, 714, 716, 717, 719, 720, 722, 723, 724, 725, 726, 727, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 805, 806, 807, 808, 810, 812, 813, 814, 815, 816, 817, 818, 820, 821, 822, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 836, 839, 840, 841, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 866, 867, 868, 869, 870, 872, 873, 874, 875, 876, 877, 878, 879, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 892, 893, 894, 895, 896, 897, 898, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 914, 915, 917, 918, 919, 920, 921, 922, 923, 924, 926, 927, 928, 929, 930, 932, 933, 934, 935, 936, 937, 938, 940, 941, 942, 943, 944, 945, 947, 948, 949, 950, 951, 952, 953, 955, 956, 957, 959, 960, 962, 963, 965, 967, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998])]

```
In this list, there are tuples, where the first element is an number, and the second element is a list of integers. The 0th element of each tuple is the number of transmissions, and the list contains all the people who had that many transmissions. For example, when interpreting the above output, person 28 had 193 transmissions, person 19 had 180 transmissions, etc.